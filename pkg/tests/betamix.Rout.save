
R version 3.2.0 (2015-04-16) -- "Full of Ingredients"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ## package and data
> library("betareg")
> data("ReadingSkills", package = "betareg")
> 
> ## beta regression mixture model
> set.seed(1071)
> rs_mix <- betamix(accuracy ~ iq, data = ReadingSkills, k = 3,
+   extra_components = extraComponent(type = "uniform",
+     coef = 0.99, delta = 0.01), nstart = 10)
> 
> ## fitted model
> print(rs_mix)

Call:
betamix(formula = accuracy ~ iq, data = ReadingSkills, k = 3, 
    nstart = 10, extra_components = extraComponent(type = "uniform", 
        coef = 0.99, delta = 0.01))

Cluster sizes:
 1  2  3 
10 20 14 

convergence after 43 iterations
> summary(rs_mix)
$Comp.1
$Comp.1$mean
            Estimate Std. Error z value  Pr(>|z|)    
(Intercept)  1.40342    0.26332  5.3296 9.842e-08 ***
iq           0.82502    0.21630  3.8142 0.0001366 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

$Comp.1$precision
            Estimate Std. Error z value  Pr(>|z|)    
(Intercept)  2.68508    0.45435  5.9097 3.428e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


$Comp.2
$Comp.2$mean
             Estimate Std. Error z value  Pr(>|z|)    
(Intercept)  0.502523   0.082476  6.0930 1.108e-09 ***
iq          -0.048414   0.112923 -0.4287    0.6681    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

$Comp.2$precision
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  4.25160    0.74737  5.6888 1.28e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


> 
> ## further methods
> table(clusters(rs_mix), ReadingSkills$dyslexia)
   
    no yes
  1  7   3
  2  4  16
  3 14   0
> round(posterior(rs_mix), digits = 4)
        [,1]   [,2]   [,3]
 [1,] 1.0000 0.0000 0.0000
 [2,] 0.8670 0.1330 0.0000
 [3,] 1.0000 0.0000 0.0000
 [4,] 0.1524 0.0000 0.8476
 [5,] 1.0000 0.0000 0.0000
 [6,] 0.4654 0.5346 0.0000
 [7,] 0.9255 0.0745 0.0000
 [8,] 0.0000 0.0000 1.0000
 [9,] 0.0022 0.0000 0.9978
[10,] 0.0943 0.0000 0.9057
[11,] 0.0307 0.0000 0.9693
[12,] 0.1626 0.0000 0.8374
[13,] 0.0402 0.0000 0.9598
[14,] 0.2679 0.0000 0.7321
[15,] 0.0002 0.0000 0.9998
[16,] 0.0402 0.0000 0.9598
[17,] 0.3605 0.6395 0.0000
[18,] 0.2545 0.0000 0.7455
[19,] 0.0796 0.9204 0.0000
[20,] 0.2378 0.0000 0.7622
[21,] 1.0000 0.0000 0.0000
[22,] 0.0008 0.0000 0.9992
[23,] 0.6718 0.3282 0.0000
[24,] 0.0410 0.9590 0.0000
[25,] 0.2593 0.0000 0.7407
[26,] 0.0820 0.9180 0.0000
[27,] 0.1366 0.8634 0.0000
[28,] 0.8388 0.1612 0.0000
[29,] 0.1845 0.8155 0.0000
[30,] 0.2558 0.7442 0.0000
[31,] 0.0394 0.9606 0.0000
[32,] 0.0100 0.9900 0.0000
[33,] 0.0029 0.9971 0.0000
[34,] 0.3357 0.6643 0.0000
[35,] 0.1004 0.8996 0.0000
[36,] 0.5048 0.4952 0.0000
[37,] 0.3669 0.6331 0.0000
[38,] 0.1337 0.8663 0.0000
[39,] 0.5545 0.4455 0.0000
[40,] 0.3209 0.6791 0.0000
[41,] 0.3069 0.6931 0.0000
[42,] 0.2416 0.7584 0.0000
[43,] 0.2812 0.7188 0.0000
[44,] 0.2555 0.7445 0.0000
> 
> proc.time()
   user  system elapsed 
 18.712   0.152  19.787 
