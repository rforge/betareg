
R version 3.2.0 (2015-04-16) -- "Full of Ingredients"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ## package and data
> library("betareg")
> data("ReadingSkills", package = "betareg")
> 
> ## augment with random noise
> set.seed(1071)
> n <- nrow(ReadingSkills)
> ReadingSkills$x1 <- rnorm(n)
> ReadingSkills$x2 <- runif(n)
> ReadingSkills$x3 <- factor(sample(0:1, n, replace = TRUE))
> 
> ## fit beta regression tree
> rs_tree <- betatree(accuracy ~ iq | iq, ~ dyslexia + x1 + x2 + x3,
+   data = ReadingSkills, minsplit = 10)
> 
> ## methods
> print(rs_tree)
Beta regression tree

Model formula:
accuracy ~ iq + iq | dyslexia + x1 + x2 + x3

Fitted party:
[1] root
|   [2] dyslexia in no: n = 25
|             (Intercept)                iq (phi)_(Intercept)          (phi)_iq 
|                1.656525          1.465708          1.272597          2.047858 
|   [3] dyslexia in yes: n = 19
|             (Intercept)                iq (phi)_(Intercept)          (phi)_iq 
|              0.38093218       -0.08622808        4.80766206        0.82603290 

Number of inner nodes:    1
Number of terminal nodes: 2
Number of parameters per node: 4
Objective function (negative log-likelihood): 66.73409
> summary(rs_tree)
$`2`

Call:
betatree(formula = accuracy ~ iq | iq, data = ReadingSkills)

Standardized weighted residuals 2:
    Min      1Q  Median      3Q     Max 
-1.8205 -0.5211  0.0615  0.8490  1.0627 

Coefficients (mean model with logit link):
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)   1.6565     0.2864   5.785 7.27e-09 ***
iq            1.4657     0.2475   5.921 3.20e-09 ***

Phi coefficients (precision model with log link):
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)   1.2726     0.3068   4.148 3.36e-05 ***
iq            2.0479     0.3306   6.194 5.85e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Type of estimator: ML (maximum likelihood)
Log-likelihood: 39.41 on 4 Df
Pseudo R-squared: 0.1487
Number of iterations: 17 (BFGS) + 1 (Fisher scoring) 

$`3`

Call:
betatree(formula = accuracy ~ iq | iq, data = ReadingSkills)

Standardized weighted residuals 2:
    Min      1Q  Median      3Q     Max 
-2.4554 -0.6593 -0.0787  0.8127  1.6104 

Coefficients (mean model with logit link):
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  0.38093    0.04863   7.833 4.76e-15 ***
iq          -0.08623    0.05492  -1.570    0.116    

Phi coefficients (precision model with log link):
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)   4.8077     0.4142  11.607   <2e-16 ***
iq            0.8260     0.3946   2.093   0.0363 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Type of estimator: ML (maximum likelihood)
Log-likelihood: 27.33 on 4 Df
Pseudo R-squared: 0.03907
Number of iterations: 16 (BFGS) + 2 (Fisher scoring) 

> coef(rs_tree)
  (Intercept)          iq (phi)_(Intercept)  (phi)_iq
2   1.6565251  1.46570750          1.272597 2.0478577
3   0.3809322 -0.08622808          4.807662 0.8260329
> library("strucchange")
Loading required package: zoo

Attaching package: 'zoo'

The following objects are masked from 'package:base':

    as.Date, as.Date.numeric

Loading required package: sandwich
> sctest(rs_tree)
$`1`
              dyslexia        x1       x2        x3
statistic 2.268741e+01 8.5250963 5.569861 3.6273300
p.value   5.847856e-04 0.9094631 0.998710 0.9142006

$`2`
          dyslexia        x1        x2        x3
statistic        0 6.4116323 4.5170190 8.2019125
p.value         NA 0.8412097 0.9751644 0.2325712

$`3`
NULL

> 
> proc.time()
   user  system elapsed 
  2.152   0.032   2.210 
